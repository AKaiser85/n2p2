n2p2 - The neural network potential package
===========================================

# Overview

Welcome to the documentation for the neural network potential package! This
repository (obtain source code
[__here__](http://github.com/CompPhysVienna/n2p2)) provides ready-to-use
software for high-dimensional neural network potentials in materials science.
The methodology behind the Behler-Parinello neural network potentials was first
described here:

[J. Behler and M. Parrinello, Phys. Rev. Lett. 98, 146401 (2007)](https://doi.org/10.1103/PhysRevLett.98.146401)

This package contains software that will allow you to use existing neural
network potential parameterizations to predict energies and forces (with
standalone tools but also in conjunction with the MD software
[LAMMPS](http://lammps.sandia.gov/)). In addition it is possible to train new
neural network potentials with the provided training tools.

# Documentation

@warning
Unfortunately many parts of the documentation are still unfinished and will
be completed little by little.

## Online version
This package uses automatic documentation generation via
[doxygen](http://www.stack.nl/~dimitri/doxygen/). An online version of the
documentation which is automatically updated with the main repository can be
found [__here__](http://compphysvienna.github.io/n2p2).

## Build your own documentation
It is also possible to build your own documentation for offline reading. This
requires [doxygen](http://www.stack.nl/~dimitri/doxygen/) and
[graphviz](https://www.graphviz.org/) to be installed on your system (tested
with doxygen version 1.8.14 and graphviz version 2.36.0). If the requirements
are met change to the `src` directory and try to build the documentation:
```
cd src
make doc
```
If the build process succeeds you can browse through the documentation starting
from the main page in:
```
doc/html/index.html
```
@note
If `graphviz` is not available on your system you can still build the
documentation if you set the option `HAVE_DOT` in the file `src/doc/Doxyfile` to
`NO`. However, then there will be no graphs generated by `doxygen`.

## Quick links

- [Atomic environment descriptors](descriptors.md)
- [Input file keywords](keywords.md)
- [LAMMPS interface build instructions](if_lammps.md)
- [__LAMMPS pair style reference__](pair_nnp.html)
- [Structure file format](cfg_file.md)


# Purpose

This repository provides applications for multiple purposes. Depending on your
task at hand you may only need individual parts and do not need to compile all
components (see components table below). As a new user you may find yourself in
one of these three possible scenarios:

## Prediction with existing neural network potential

If you have a working neural network potential setup (i.e. a settings file with
network and symmetry function parameters, weight files and a scaling file)
ready and want to predict energies and forces for a single structure you only
need these components:

- [libnnp](libnnp.md)
- [nnp-predict](nnp-predict.md)

## Molecular dynamics simulation

Similarly, if you have a working neural network potential setup and would like
to run an MD simulation with an external MD software (so far only LAMMPS is
supported), these components are required:

- [libnnp](libnnp.md)
- `libnnpif`
- [pair_style nnp](if_lammps.md)

## Training a new neural network potential

To train a completely new neural network potential the following parts are required:

- [libnnp](libnnp.md)
- `libnnptrain`
- [nnp-scaling](nnp-scaling.md)
- [nnp-train](nnp-train.md)

Additional, though not strictly required tools, are also quite useful:

- [nnp-comp2](nnp-comp2.md)
- [nnp-convert](nnp-convert.md)
- [nnp-dataset](nnp-dataset.md)
- [nnp-dist](nnp-dist.md)
- [nnp-norm](nnp-norm.md)
- [nnp-prune](nnp-prune.md)
- [nnp-select](nnp-select.md)
- [nnp-symfunc](nnp-symfunc.md)

# Build process

## Code structure

This package contains multiple components with varying interdependencies and
dependencies on third-party libraries. You may not need to build all
components, this depends on the intended use. The following table lists all
components and their respective requirements (follow the links for more
information).

| Component                       | Location                        | Requirements               | Function                                             |
| ------------------------------- | ------------------------------- | -------------------------- | ---------------------------------------------------- |
| [libnnp](libnnp.md)             | `src`                           | C++98 compiler (icpc, g++) | NNP core library (NN, SF, Structure, ...)            |
| libnnpif                        | `src`                           | `libnnp`, MPI              | Interfaces to other software (LAMMPS, ...)           |
| libnnptrain                     | `src`                           | `libnnp`, MPI, GSL, Eigen  | Dataset and training routines (Kalman, ...).         |
| [nnp-convert](nnp-convert.md)   | `src/application`               | `libnnp`                   | Convert between structure file formats.              |
| [nnp-cutoff](nnp-cutoff.md)     | `src/application`               | `libnnp`                   | Test speed of different cutoff functions.            |
| [nnp-dist](nnp-dist.md)         | `src/application`               | `libnnp`                   | Calculate radial and angular distribution functions. |
| [nnp-predict](nnp-predict.md)   | `src/application`               | `libnnp`                   | Predict energy and forces for one structure.         |
| [nnp-prune](nnp-prune.md)       | `src/application`               | `libnnp`                   | Prune symmetry functions.                            |
| [nnp-select](nnp-select.md)     | `src/application`               | `libnnp`                   | Select subset from data set.                         |
| [nnp-symfunc](nnp-symfunc.md)   | `src/application`               | `libnnp`                   | Symmetry function shape from settings file.          |
| [nnp-comp2](nnp-comp2.md)       | `src/application`               | `libnnptrain`              | Compare prediction of 2 NNPs for data set.           |
| [nnp-dataset](nnp-dataset.md)   | `src/application`               | `libnnptrain`              | Calculate energies and forces for a whole data set.  |
| [nnp-norm](nnp-norm.md)         | `src/application`               | `libnnptrain`              | Calculate normalization factors for data set.        |
| [nnp-scaling](nnp-scaling.md)   | `src/application`               | `libnnptrain`              | Calculate symmetry function values for data set.     |
| [nnp-train](nnp-train.md)       | `src/application`               | `libnnptrain`              | Train a neural network potential.                    |
| [pair_style  nnp](if_lammps.md) | `src/interface/LAMMPS`          | `libnnpif`                 | %Pair style `nnp` for LAMMPS                         |
| [pynnp](pynnp.md)               | `src/`                          | `libnnp`, python, cython   | Python interface to NNP library.                     |
| doc                             | `src/doc`                       | doxygen, graphviz          | Doxygen documentation.                               |

## The simple way using the master makefile

A master makefile is provided in the `src` directory which provides targets for
all individual components (except for the LAMMPS [pair_style  nnp](if_lammps.md)).
For instance, compiling the interface library `libnnpif` requires only to type
```
cd src
make libnnpif-shared
```
This will automatically build a shared version (for dynamic linking) of the
required library `libnnp` and the requested `libnnpif`.  Similarly, a static
build is done like this:
```
make libnnpif-static
```
To build everything (all libraries and tools) type:
```
make shared
```
or
```
make static
```
Compiled binaries will be copied to the `bin` path (relative to the root
directory), whereas libraries can be found in the `lib` folder.  To clean up
individual components or everything use one of these makefile targets
```
make clean
make clean-doc
make clean-libnnpif
```
Have a look at the main makefile in `src` for all available build
targets.

Currently the build process has been tested with two different compilers, the
GNU compiler g++ 5.4 (`gnu`) and the Intel compiler 17 (`intel`). It is
possible to switch between them via the `COMP` variable, e.g.
```
make libnnp COMP=intel
```
If you need to change compiler variables and paths have a look at the
corresponding makefiles containing global build parameters:
```
src/makefile.gnu
src/makefile.intel
```
You can also create new parameter makefiles based on the above and change the
file name suffix according to your target:
```
src/makefile.target
make libnnp COMP=target
```
By default the makefile will use 4 processors for compiling multiple files at
once, this behaviour can be overriden with the CORES switch, e.g. to use 8
cores:
```
make libnnp CORES=-j8
```
@warning
Do not use the `-j` switch for the master makefile, this may mess up
the compilation order.

## Individual component makefiles

It is also possible to invoke individual makefiles for each component manually.
Just switch to the corresponding folder and use `make shared` or `make static`.

# Examples

Working minimal examples for each application can be found in the `examples`
directory.

# Keywords

The setup of a neural network potential (network topology, symmetry function
parameters,...) is stored in a simple text file with keyword-argument pairs. A
list of keywords is provided [here](keywords.md).

# Authors

 - Andreas Singraber (University of Vienna)

# License

This software is licensed under the [GNU General Public License version 3 or any later version (GPL-3.0-or-later)](https://www.gnu.org/licenses/gpl.txt).

# Changelog

See what's [new](CHANGELOG.md).
